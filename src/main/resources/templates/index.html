<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.6/dist/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.2.1/dist/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.3/js/select2.min.js"></script>
    <title>Document</title>
    <style>
        body {
            background-color: rgb(238, 238, 238);
        }
       .headbar {
         background-color: #4094cf;
         color : white;
         font-weight: 500;
         height: 150px;
         padding: 1rem;
       }
       .main-content {
        margin-top: 1rem;
       }
    </style>
</head>
<body>
<div class="headbar">
    <div class="row">
        <div class="col-10" style="font-size: 1.5rem;">Commerce Kickstart</div>
        <div class="col-2" style="margin-left: 0rem;">
            <span><a style="color:white;" href="#">My Account&nbsp</a></span>
            <span><a style="color:white" href="#">Logout&nbsp</a></span>
        </div>
    </div>
</div>
<div class="main-content container-fluid">
    <div class="text-center">
        <span style="color: #4094cf;font-size: 1.5rem;">Home</span>
    </div>
    <div class="mt-5">
        <div class="d-inline-block"><h4>Customer : </h4></div>
        <div class="d-inline-block">Tomjerry</div>
    </div>
    <div>
        <div class="d-inline-block"><h4>Address : </h4></div>
        <div class="d-inline-block">Jl. Tali No.9, Jakarta </div>
    </div>
    <div class="mt-5"></div>
    <h1>Shopping Cart</h1>
    <table class="table mt-5">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">Name</th>
            <th scope="col">Type</th>
            <th scope="col">Price</th>
            <th scope="col">Qty</th>
            <th scope="col">Total</th>
        </tr>
        </thead>
        <tbody class="table-group-divider">
        <tr>
            <th scope="row">1</th>
            <td>Mark</td>
            <td>Otto</td>
            <td>@mdo</td>
            <td>@mdo</td>
            <td>@mdo</td>
        </tr>
        <tr>
            <th scope="row">2</th>
            <td>Jacob</td>
            <td>Thornton</td>
            <td>@fat</td>
            <td>@mdo</td>
            <td>@mdo</td>
        </tr>
        <tr>
            <th scope="row">3</th>
            <td>Larry the Bird</td>
            <td>@twitter</td>
            <td>@mdo</td>
            <td>@mdo</td>
            <td>@mdo</td>
        </tr>
        <tr>
            <th scope="row">
            <td></td>
            <td style="font-weight: 500;">Total</td>
            <td></td>
            <td></td>
            <td style="font-weight: 500;font-size: 1rem;">100000</td>
            </th>
        </tr>
        </tbody>
    </table>
    <div class="d-inline-block">
        <button type="button" class="btn btn-success" data-toggle="modal" data-target="#exampleModal">Buy Item</button>
    </div>
    <div class="text-center" style="margin-top: -2rem;">
        <button class="btn btn-primary">Place Order</button>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header border-0">
                    <h5 class="modal-title" id="exampleModalLabel"></h5>
                </div>
                <div class="modal-body">
                    <form>
                        <select id="mySelectType" class="form-control" style="width: 100%;"></select>
                        <div class="mt-4">
                            <select id="mySelectItem" class="form-control" style="width: 100%;"></select>
                        </div>

                        <!-- <div class="mb-3">
                          <input type="name" class="form-control" id="exampleInputName" aria-describedby="nameHelp" placeholder="Name">
                        </div> -->
                        <div class="mt-3">
                            <input type="price" class="form-control" id="examplePrice" aria-describedby="priceHelp" placeholder="price">
                        </div>
                        <div class="input-group w-auto justify-content-end align-items-center mt-2">
                            <input type="button" value="-" class="button-minus border rounded-circle icon-shape icon-sm" data-field="quantity">
                            <input type="number" step="1" max="10" value="1" name="quantity" class="quantity-field border-0 text-center" style="width: 10%;" id="qtyUpdate">
                            <input type="button" value="+" class="button-plus border rounded-circle icon-shape icon-sm" data-field="quantity" step="">
                        </div>
                    </form>
                </div>
                <div class="modal-footer border-0">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-success">Add To Cart</button>
                </div>
            </div>
        </div>
    </div>

</body>
<script>
    let typeSelected;
    let qty;
    $('#mySelectType').change(function() {
        typeSelected = $('#mySelectType').find(':selected').val();
    });
    $('#mySelectItem').change(function() {
        let data = $('#mySelectItem').find(':selected').data();
        let itemPrice = data.data.itemPrice;
        $('#examplePrice').val(itemPrice);
    });
    $('#qtyUpdate').on(function() {
        qty = ('#qtyUpdate').val();
    });
    $('#mySelectType').select2({
                ajax: {
                    url: 'http://localhost:8080/api/type', // Replace with your API endpoint
                    type: 'POST',
                    data: function (params) {
                        return {
                            searchTerm: params.term,
                            // Add any additional parameters you need
                        };
                    },
                    processResults: function (response) {
                        var res = response.data.map(function (item) {
                            return {id: item.typeId, text: item.typeName};
                        });
                        return {
                            results: res
                        };
                    }
                },
                placeholder: 'Select an category',
                dropdownParent: $('#exampleModal')
    });
    $('#mySelectItem').select2({
                ajax: {
                    url: 'http://localhost:8080/api/item', // Replace with your API endpoint
                    type: 'POST',
                    contentType: "application/json",
                    data:function(term, page) {
                        return JSON.stringify(
                            {
                                "typeId": Number(typeSelected)
                            }
                        );
                    },
                    processResults: function (response) {
                        var res = response.data.map(function (item) {
                            return {id: item.itemId, text: item.itemName, itemPrice:item.itemPrice};
                        });
                        return {
                            results: res
                        };
                    }
                },
                placeholder: 'Select an item',
                dropdownParent: $('#exampleModal')
    });

    $('#exampleModal').on('shown.bs.modal', function () {

    })

    $('.input-group').on('click', '.button-plus', function(e) {
        incrementValue(e);
    });

    $('.input-group').on('click', '.button-minus', function(e) {
        decrementValue(e);
    });

    function incrementValue(e) {
        e.preventDefault();
        var fieldName = $(e.target).data('field');
        var parent = $(e.target).closest('div');
        var currentVal = parseInt(parent.find('input[name=' + fieldName + ']').val(), 10);

        if (!isNaN(currentVal)) {
            parent.find('input[name=' + fieldName + ']').val(currentVal + 1);
        } else {
            parent.find('input[name=' + fieldName + ']').val(0);
        }
    }

    function decrementValue(e) {
        e.preventDefault();
        var fieldName = $(e.target).data('field');
        var parent = $(e.target).closest('div');
        var currentVal = parseInt(parent.find('input[name=' + fieldName + ']').val(), 10);

        if (!isNaN(currentVal) && currentVal > 0) {
            parent.find('input[name=' + fieldName + ']').val(currentVal - 1);
        } else {
            parent.find('input[name=' + fieldName + ']').val(0);
        }
    }


</script>
</html>